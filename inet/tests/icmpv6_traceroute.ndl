module Host {
    gates {
        port
    }
}

module Switch {
    gates {
        port[3]
    }
}

module Router {
    gates {
        lan,
        wan[3]
    }
}

link LANLink {
    bitrate: 100000000,
    jitter: 0.0,
    latency: 0.01
}

link WANLink {
    bitrate: 100000000,
    jitter: 0.0,
    latency: 0.05
}

module LAN {
    gates {
        wan[3]
    }

    submodules {
        host[2]: Host,
        switch: Switch,
        router: Router,
    }

    connections {
        host[0]/port <-- LANLink --> switch/port[0],
        host[1]/port <-- LANLink --> switch/port[1],
        router/lan <-- LANLink --> switch/port[2],
        wan <--> router/wan
    }
}

module Main {
    submodules {
        net[5]: LAN
    }

    connections {
        net[0]/wan[0] <-- WANLink --> net[1]/wan[0],
        net[0]/wan[1] <-- WANLink --> net[2]/wan[1],
        net[1]/wan[1] <-- WANLink --> net[2]/wan[0],
        net[1]/wan[2] <-- WANLink --> net[3]/wan[0],
        net[2]/wan[2] <-- WANLink --> net[3]/wan[1],
        net[3]/wan[2] <-- WANLink --> net[4]/wan[0]
    }
}

entry Main;